* :memo: :Excel: 関数 複数条件での抽出

=INDEX(抽出範囲,MATCH(条件１&条件２,INDEX(検査範囲１&検査範囲２),0))
  ※複数の検索条件を＆でつなげることで１つの文字列とみなす
    検査範囲も＆でつなげるためにindex関数を使用した

配列認識が必要 (Ctrl + Shift + Enter)
=INDEX(抽出範囲,MATCH(条件１,IF(範囲２=条件２,検査範囲１),0))
  ※match関数の検査範囲の指定部分でif関数による第２条件のマッチングの判定を加えた

配列認識に加え左端に番号欄も必要
=INDEX(抽出範囲,MATCH(MAX((番号)*(検査範囲１=条件１)*(検査範囲２=条件２)),番号,0))
=VLOOKUP(MAX((番号)*(検査範囲１=検索項目１)*(検査範囲２=検索項目２)),抽出範囲,4,0)
  ※左端に検索用番号欄を作成し、max関数で複数条件のマッチングから番号を抽出した

[2013-09-10 17:23] 

